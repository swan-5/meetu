<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MeetU | ëŒ€í•™ìƒ íŒ€ ë¯¸íŒ…</title>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg0: #0b0610; --bg1: #120818;
      --pink: #ff4fd8; --rose: #ff3b8d; --purple: #9d50bb;
      --text: rgba(255, 255, 255, 0.92); --muted: rgba(255, 255, 255, 0.6);
      --glass: rgba(255, 255, 255, 0.05);
      --border: rgba(255, 255, 255, 0.1);
    }

    * { box-sizing: border-box; transition: all 0.3s ease; }
    body {
      margin: 0; font-family: "Pretendard", sans-serif; color: var(--text);
      background: radial-gradient(circle at 20% 20%, rgba(157, 80, 187, 0.2), transparent 40%),
                  radial-gradient(circle at 80% 80%, rgba(255, 79, 216, 0.15), transparent 40%),
                  var(--bg0);
      min-height: 100vh; overflow-x: hidden;
    }

    .container { width: min(1000px, 92vw); margin: 0 auto; }

    /* Header & Nav */
    .topbar {
      position: sticky; top: 0; z-index: 100;
      backdrop-filter: blur(15px); background: rgba(11, 6, 16, 0.7);
      border-bottom: 1px solid var(--border); padding: 12px 0;
    }
    .topbar-inner { display: flex; align-items: center; justify-content: space-between; }
    .brand { display: flex; align-items: center; gap: 10px; font-weight: 800; font-size: 1.2rem; cursor: pointer; }
    .nav { display: flex; gap: 8px; }
    .tab {
      padding: 8px 16px; border-radius: 20px; border: 1px solid var(--border);
      background: var(--glass); color: white; cursor: pointer; font-size: 13px; font-weight: 600;
    }
    .tab.active { background: linear-gradient(135deg, var(--pink), var(--rose)); border: none; box-shadow: 0 4px 15px rgba(255, 79, 216, 0.3); }

    /* Section Control */
    .section { display: none; padding: 40px 0 100px; animation: fadeIn 0.5s ease both; }
    .section.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* Landing (Hero) Style */
    #landing { height: 75vh; display: flex; align-items: center; justify-content: center; text-align: center; }
    .hero-card {
      background: var(--glass); border: 1px solid var(--border); border-radius: 30px;
      padding: 60px 40px; backdrop-filter: blur(20px); box-shadow: 0 25px 50px rgba(0,0,0,0.3);
      width: 100%; animation: float 4s ease-in-out infinite;
    }
    @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
    .gradient-text { background: linear-gradient(to right, var(--pink), var(--purple)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

    /* Common Card Style */
    .card { background: var(--glass); border: 1px solid var(--border); border-radius: 24px; padding: 32px; backdrop-filter: blur(10px); }
    h2 { margin-top: 0; font-weight: 800; font-size: 1.8rem; }

    /* Form Styles */
    .form { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
    @media (max-width: 600px) { .form { grid-template-columns: 1fr; } }
    .field { display: flex; flex-direction: column; gap: 8px; }
    label { font-size: 13px; font-weight: 700; color: var(--muted); }
    input, textarea {
      background: rgba(0,0,0,0.3); border: 1px solid var(--border);
      color: white; padding: 14px; border-radius: 12px; font-size: 15px;
    }
    input:focus { border-color: var(--pink); outline: none; background: rgba(0,0,0,0.5); }

    /* Buttons */
    .btn-primary {
      background: linear-gradient(135deg, var(--pink), var(--rose));
      color: white; border: none; padding: 16px; border-radius: 14px;
      font-weight: 800; font-size: 1.1rem; cursor: pointer; width: 100%; margin-top: 20px;
    }
    .btn-primary:hover { transform: scale(1.02); box-shadow: 0 10px 25px rgba(255, 79, 216, 0.4); }

    .toast { position: fixed; left: 50%; bottom: 30px; transform: translateX(-50%); padding: 12px 24px; border-radius: 999px; background: rgba(255,255,255,0.9); color: #000; font-weight: 700; display: none; z-index: 1000; }
  .matching-status {
  padding: 40px;
  border: 2px dashed var(--border);
  border-radius: 20px;
  margin-top: 20px;
  background: rgba(255, 79, 216, 0.03);
}
.pulse-icon {
  font-size: 3rem;
  animation: pulse 2s infinite;
}
@keyframes pulse {
  0% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.2); opacity: 0.7; }
  100% { transform: scale(1); opacity: 1; }
}
  </style>
</head>
<body>

 <header class="topbar">
    <div class="container topbar-inner">
      <div class="brand" onclick="go('landing')">
        <img src="logo.jpg" alt="logo" style="width:32px; height:32px; border-radius:8px; object-fit:cover;">
        <span>Meet<span class="gradient-text">U</span></span>
      </div>
      <nav class="nav">
        <button class="tab active" data-tab="landing" onclick="go('landing')">í™ˆ</button>
        <button class="tab" data-tab="login" onclick="go('login')">ë¡œê·¸ì¸</button>
        <button class="tab" data-tab="auth" onclick="go('auth')">íšŒì›ê°€ì…</button>
        <button class="tab" data-tab="profile" onclick="go('profile')">ë§ˆì´í˜ì´ì§€</button>
        <button class="tab" data-tab="match" onclick="go('match')">ë§¤ì¹­í˜„í™©</button> </nav>
    </div>
</header>

  <main class="container">
    <section id="landing" class="section active">
      <div class="hero-card">
        <div style="font-size: 3rem; margin-bottom: 10px;">ğŸ’˜</div>
        <h1>Meet<span class="gradient-text">U</span></h1>
        <p>ìš°ë¦¬ë¼ë¦¬ ë” ì¦ê±°ìš´ ì‹œê°„,<br>ê²€ì¦ëœ ëŒ€í•™ìƒë“¤ì˜ <strong>í”„ë¼ì´ë¹— íŒ€ ë¯¸íŒ…</strong></p>
        <button class="btn-primary" style="max-width: 280px;" onclick="go('match')">ì§€ê¸ˆ ì‹œì‘í•˜ê¸° ğŸš€</button>
      </div>
    </section>
    <section id="match" class="section">
      <div class="card" style="text-align: center;">
        <h2>ë§¤ì¹­ í˜„í™© âœ¨</h2>
        <div class="matching-status">
            <div class="pulse-icon">ğŸ”</div>
            <h3 style="margin-top: 20px;">ë‚˜ì™€ ë”± ë§ëŠ” íŒ€ì„ ì°¾ëŠ” ì¤‘...</h3>
            <p style="color: var(--muted);">í•™ìƒì¦ ì¸ì¦ì´ ì™„ë£Œë˜ë©´ ë§¤ì¹­ì´ ì‹œì‘ë©ë‹ˆë‹¤.</p>
        </div>
        <div style="margin-top: 30px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <div class="card" style="padding: 15px; font-size: 14px;">í˜„ì¬ ëŒ€ê¸° íŒ€: <strong>12íŒ€</strong></div>
            <div class="card" style="padding: 15px; font-size: 14px;">ì˜¤ëŠ˜ ë§¤ì¹­ ì™„ë£Œ: <strong>5ê±´</strong></div>
        </div>
        <button class="btn-primary" style="margin-top: 30px; background: none; border: 1px solid var(--pink); color: var(--pink);" onclick="go('profile')">ë‚´ í”„ë¡œí•„ ìˆ˜ì •í•˜ëŸ¬ ê°€ê¸°</button>
      </div>
    </section>


    <section id="login" class="section">
      <div class="card" style="max-width: 450px; margin: 0 auto;">
        <h2> Login </h2>
        <div class="field" style="margin-top: 20px;"><label>ì•„ì´ë””</label><input id="lId" type="text" placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></div>
        <div class="field" style="margin-top: 15px;"><label>ë¹„ë°€ë²ˆí˜¸</label><input id="lPw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></div>
        <button class="btn-primary" onclick="handleLogin()">ë¡œê·¸ì¸í•˜ê¸°</button>
      </div>
    </section>

    <section id="auth" class="section">
      <div class="card">
        <h2>ë©¤ë²„ ê°€ì…í•˜ê¸° ğŸ“</h2>
        <div class="form">
          <div class="field"><label>ì•„ì´ë””</label><input id="rId" type="text"></div>
          <div class="field"><label>ë¹„ë°€ë²ˆí˜¸</label><input id="rPw" type="password"></div>
          <div class="field"><label>ì´ë¦„(ì‹¤ëª…)</label><input id="rName" type="text"></div>
          <div class="field"><label>í•™êµ</label><input id="rUniv" type="text" placeholder="00ëŒ€í•™êµ"></div>
          <div class="field"><label>í•™ê³¼</label><input id="rMajor" type="text" placeholder="00í•™ê³¼"></div>
          <div class="field"><label>ë‚˜ì´</label><input id="rAge" type="number"></div>
          <div class="field"><label>í‚¤(cm)</label><input id="rHeight" type="number"></div>
          <div class="field" style="grid-column: 1/-1;">
            <label>í•™ìƒì¦ ì‚¬ì§„ ì—…ë¡œë“œ (ì¸ì¦ìš©)</label>
            <input id="studentCard" type="file" accept="image/*">
          </div>
        </div>
        <button class="btn-primary" onclick="handleRegister()">ê°€ì… ë° ì¸ì¦ìš”ì²­ âœ¨</button>
      </div>
    </section>

    <section id="profile" class="section">
      <div class="card">
        <h2>ë‚´ í”„ë¡œí•„ ê´€ë¦¬ ğŸ’</h2>
        <div class="form">
          <div class="field"><label>ë‹‰ë„¤ì„</label><input id="pNick" type="text"></div>
          <div class="field"><label>ë‚˜ì˜ MBTI</label><input id="pMbti" type="text"></div>
          <div class="field"><label>í˜„ì¬ í‚¤(cm)</label><input id="pHeight" type="number"></div>
          <div class="field"><label>ì´ìƒí˜•</label><input id="pIdeal" type="text"></div>
          <div class="field"><label>ì„ í˜¸ MBTI</label><input id="pPrefMbti" type="text"></div>
          <div class="field"><label>ì„ í˜¸ ë‚˜ì´ëŒ€</label><input id="pPrefAge" type="text"></div>
          <div class="field" style="grid-column: 1/-1;"><label>ì´ê±´ ë†“ì¹˜ê¸° ì‹«ë‹¤! âœ¨</label><input id="pMustHave" type="text" placeholder="ì˜ˆ: ë¹„í¡ì—°ì, ì—°ë½ ì†ë„ ë“±"></div>
          <div class="field" style="grid-column: 1/-1;"><label>ìê¸°ì†Œê°œ ë° ì·¨ë¯¸</label><textarea id="pDesc" rows="3"></textarea></div>
        </div>
        <button class="btn-primary" onclick="handleUpdate()">ì •ë³´ ì—…ë°ì´íŠ¸ ì™„ë£Œ ğŸ’¾</button>
      </div>
    </section>
  </main>

  <div id="toast" class="toast"></div>

  <script>
    let curId = null, curUniv = "", curMajor = "", curAge = 0;

    function go(id) {
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    const activeTab = document.querySelector(`[data-tab="${id}"]`);
    if(activeTab) activeTab.classList.add('active');
    window.scrollTo(0,0);
    }

    function val(id) { return document.getElementById(id).value; }
    function toast(msg) {
      const t = document.getElementById('toast');
      t.textContent = msg; t.style.display = 'block';
      setTimeout(() => t.style.display = 'none', 2500);
    }

    async function handleRegister() {
      const f = document.getElementById('studentCard').files[0];
      if(!f) return alert("í•™ìƒì¦ ì‚¬ì§„ì„ ì˜¬ë ¤ì£¼ì„¸ìš”!");
      const p = {login_id:val('rId'), password:val('rPw'), name:val('rName'), university:val('rUniv'), major:val('rMajor'), age:parseInt(val('rAge'))||0, height:parseInt(val('rHeight'))||0};
      
      try {
        const res = await fetch('http://127.0.0.1:8000/users/register', {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(p)});
        const d = await res.json();
        if(res.ok){
          const fd = new FormData(); fd.append("file", f);
          await fetch(`http://127.0.0.1:8000/upload/student-card/${d.user_id}`, {method:'POST', body:fd});
          alert("ê°€ì… ì„±ê³µ! ì´ì œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”."); go('login');
        } else alert(d.detail);
      } catch(e) { alert("ì„œë²„ ì—°ê²° ì‹¤íŒ¨!"); }
    }

    async function handleLogin() {
      try {
        const res = await fetch('http://127.0.0.1:8000/users/login', {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({login_id:val('lId'), password:val('lPw')})});
        const d = await res.json();
        if(res.ok){
          curId=d.user_id; curUniv=d.univ; curMajor=d.major; curAge=d.age;
          toast("ë°˜ê°€ì›Œìš”, " + d.nickname + "ë‹˜! âœ¨");
          document.getElementById('pNick').value = d.nickname;
          go('profile');
        } else alert("ë¡œê·¸ì¸ ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");
      } catch(e) { alert("ì„œë²„ ì—°ê²° ì‹¤íŒ¨!"); }
    }

    async function handleUpdate() {
      if(!curId) return alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
      const p = {
        user_id:curId, nickname:val('pNick'), university:curUniv, major:curMajor, age:curAge, 
        height:parseInt(val('pHeight'))||0, mbti:val('pMbti'), ideal_type:val('pIdeal'), 
        pref_mbti:val('pPrefMbti'), pref_age:val('pPrefAge'), must_have:val('pMustHave'), 
        description:val('pDesc'), meeting_type:"1:1"
      };
      const res = await fetch('http://127.0.0.1:8000/profiles/', {method:'PUT', headers:{'Content-Type':'application/json'}, body:JSON.stringify(p)});
      if(res.ok) toast("í”„ë¡œí•„ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ’¾");
      else alert("ì €ì¥ ì‹¤íŒ¨");
    }
  </script>
</body>
</html>